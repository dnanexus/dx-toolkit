SELECT `cohort_subquery`.`patient_id` AS `patient_id` FROM (SELECT `patient_1`.`patient_id` AS `patient_id`, `patient_1`.`hid` AS `hid` FROM `database_gyk2yg00vgppzj7ygy3vjxb9__create_cohort_pheno_database`.`patient` AS `patient_1` WHERE `patient_1`.`age` BETWEEN 20 AND 60 AND `patient_1`.`patient_id` IN ('patient_1', 'patient_2') AND (EXISTS (SELECT `hospital_1`.`hospital_id` AS `hospital_id` FROM `database_gyk2yg00vgppzj7ygy3vjxb9__create_cohort_pheno_database`.`hospital` AS `hospital_1` WHERE (`hospital_1`.`min_score_all` IN (400, 500) OR ARRAY_CONTAINS(`hospital_1`.`location_hierarchy`, 'CA') OR ARRAY_CONTAINS(`hospital_1`.`location_hierarchy`, 'BC')) AND `hospital_1`.`hospital_id` = `patient_1`.`hid`)) AND `patient_1`.`patient_id` IN (SELECT `patient_id` FROM (SELECT `cohort_subquery`.`patient_id` AS `patient_id` FROM (SELECT `patient_1`.`patient_id` AS `patient_id`, `patient_1`.`hid` AS `hid` FROM `database_gyk2yg00vgppzj7ygy3vjxb9__create_cohort_pheno_database`.`patient` AS `patient_1` WHERE EXISTS (SELECT `hospital_1`.`hospital_id` AS `hospital_id` FROM `database_gyk2yg00vgppzj7ygy3vjxb9__create_cohort_pheno_database`.`hospital` AS `hospital_1` WHERE `hospital_1`.`min_score_all` IN (500, 400) AND `hospital_1`.`hospital_id` = `patient_1`.`hid`)) AS `cohort_subquery` INTERSECT SELECT `patient_1`.`patient_id` AS `patient_id` FROM `database_gyk2yg00vgppzj7ygy3vjxb9__create_cohort_pheno_database`.`patient` AS `patient_1` WHERE `patient_1`.`name` IN ('Sally', 'Diane', 'Cassy', 'John', 'Rosaleen')))) AS `cohort_subquery`